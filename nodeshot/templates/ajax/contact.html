<div class="dialog-form ui-widget" >
    {% if not sent %}
    <form id="contact-form" class="ui-corner-all ui-widget-content" method="post" action="">
        <h1>Contatta il nodo {{ node.name }}</h1>
        <p>Tutti i campi sono obbligatori.</p>
        <fieldset>
            {% csrf_token %}
            {% if form.non_field_errors %}
                <div class="ui-state-error">
                {{ form.non_field_errors }}
                </div><br />
            {% endif %}
    
            <div class="fieldWrapper">
                <label for="id_name">Tuo nome:<label>
                {% if form.from_name.errors %}
                    <div class="ui-state-error">
                        {{ form.from_name.errors }}
                    </div>
                {% endif %}
                {{ form.from_name }}
            </div>
            
            <div class="fieldWrapper">
                <label for="id_email">Email:<label>
                {% if form.from_email.errors %}
                    <div class="ui-state-error">
                        {{ form.from_email.errors }}
                    </div>
                {% endif %}
                {{ form.from_email }}
            </div>
            
            <div class="fieldWrapper">
                <label for="id_text">Testo:<label>
                {% if form.message.errors %}
                    <div class="ui-state-error">
                        {{ form.message.errors }}
                    </div>
                {% endif %}
                {{ form.message }}
            </div>
            
            <div class="fieldWrapper">
                {% if form.math_captcha_field.errors %}
                    <div class="ui-state-error">
                        {{ form.math_captcha_field.errors }}
                    </div>
                {% endif %}
                {% autoescape off %}{{ form.math_captcha_field }}{% endautoescape %}
            </div>
            <input type="hidden" name="http_referer" value="{{ http_referer }}" />
            
            <input type="checkbox" name="honeypot" class="accessibility" />
            
            <p style="overflow:hidden">
                <input id="contact-form-submit" class="submit-button ui-priority-primary ui-corner-all ui-state-disabled hover" type="submit" value="Invia" />
                <input id="contact-form-cancel" class="cancel-button ui-priority-primary ui-corner-all ui-state-disabled hover" type="button" value="Annulla" />
            </p>
        </fieldset>
    </form>
    {% else %}
    <div id="contact-form" class="ui-corner-all ui-widget-content">
        <div id="success">
            <h1>Messaggio inviato</h1>
            <p>Richiesta di contatto inviata con successo.</p>
            <br />
        </div>
    </div>
    {% endif %}
</div>

<script>
    $('#contact-form-submit, #contact-form-cancel').button();
    var inputs = $("#node-form").find("input , select ,textarea");
    $.each(inputs,function(){
        $(this).bind({
            focusin: function() {
               $(this).toggleClass('ui-state-focus');
            },
            focusout: function() {
                $(this).toggleClass('ui-state-focus');
            }
        });
    });
</script>