(function(d){d.fn.formset=function(c){var a=d.extend({},d.fn.formset.defaults,c),j=a.extraClasses.join(" "),c=d(this),h=function(e,f){a.extraClasses&&(e.removeClass(j),e.addClass(a.extraClasses[f%a.extraClasses.length]))},i=function(a,f,d){var b=RegExp("("+f+"-\\d+-)|(^)"),f=f+"-"+d+"-";a.attr("for")&&a.attr("for",a.attr("for").replace(b,f));a.attr("id")&&a.attr("id",a.attr("id").replace(b,f));a.attr("name")&&a.attr("name",a.attr("name").replace(b,f))},g=function(e){e.is("TR")?e.children(":last").append('<a class="'+
a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a>"):e.is("UL")||e.is("OL")?e.append('<li><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></li>"):e.append('<a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a>");e.find("a."+a.deleteCssClass).click(function(){var f=d(this).parents("."+a.formCssClass),e=f.find('input:hidden[id $= "-DELETE"]');if(e.length)e.val("on"),f.hide();else{e=a.formContainerClass?d(this).parents("."+a.formContainerClass):
d("."+a.formCssClass).parent();f.remove();e=e.find(".dynamic-form").not(".formset-custom-template");d("#id_"+a.prefix+"-TOTAL_FORMS").val(e.length);for(var b=0,c=e.length;b<c;b++)h(e.eq(b),b),e.eq(b).find("input,select,textarea,label").each(function(){i(d(this),a.prefix,b)})}a.removed&&a.removed(f);return!1})};c.each(function(e){var b=d(this),c=b.find('input:checkbox[id $= "-DELETE"]');c.length&&(c.before('<input type="hidden" name="'+c.attr("name")+'" id="'+c.attr("id")+'" />'),c.remove());0<b.find("input,select,textarea,label").length&&
(g(b),b.addClass(a.formCssClass),h(b,e))});if(c.length){var b;a.formTemplate?(b=a.formTemplate instanceof d?a.formTemplate:d(a.formTemplate),b.removeAttr("id").addClass(a.formCssClass).addClass("formset-custom-template"),b.find("input,select,textarea,label").each(function(){i(d(this),a.prefix,2012)}),g(b)):(b=d("."+a.formCssClass+":last").clone(!0).removeAttr("id"),b.find('input:hidden[id $= "-DELETE"]').remove(),b.find("input,select,textarea,label").each(function(){var a=d(this);a.is("input:checkbox")||
a.is("input:radio")?a.attr("checked",!1):a.val("")}));a.formTemplate=b;"TR"==c.attr("tagName")?(b=c.eq(0).children().length,c.parent().append('<tr><td colspan="'+b+'"><a class="'+a.addCssClass+'" href="javascript:void(0)">'+a.addText+"</a></tr>"),b=c.parent().find("tr:last a"),b.parents("tr").addClass(a.formCssClass+"-add")):(c.filter(":last").after('<a class="'+a.addCssClass+'" href="javascript:void(0)">'+a.addText+"</a>"),b=c.filter(":last").next());b.click(function(){var b=parseInt(d("#id_"+a.prefix+
"-TOTAL_FORMS").val()),c=a.formTemplate.clone(!0).removeClass("formset-custom-template"),g=d(this).parents("tr."+a.formCssClass+"-add").get(0)||this;h(c,b);console.log(c,a.prefix,b);c.insertBefore(d(g)).show();c.find("input,select,textarea,label").each(function(){i(d(this),a.prefix,b)});d("#id_"+a.prefix+"-TOTAL_FORMS").val(b+1);a.added&&a.added(c);return!1})}return c};d.fn.formset.defaults={prefix:"form",formTemplate:null,addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",
formCssClass:"dynamic-form",extraClasses:[],added:null,removed:null,formContainerClass:!1}})(jQuery);